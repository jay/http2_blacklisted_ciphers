HTTP/2 blacklisted cipher check in C
====================================

This project will generate C source that can be used to check for ciphers blacklisted by HTTP/2.
For example:

```c
/* Conditional logic w/ lookup tables to check if id is banned */
#define IS_CIPHER_BANNED_METHOD2(id) ( \
  (0x0000 <= id && id <= 0x00FF && \
    "\xFF\xFF\xFF\xCF\xFF\xFF\xFF\xFF\x7F\x00\x00\x00\x80\x3F\x00\x00" \
    "\xF0\xFF\xFF\x3F\xF3\xF3\xFF\xFF\x3F\x00\x00\x00\x00\x00\x00\x80" \
    [(id & 0xFF) / 8] & (1 << (id % 8))) || \
  (0xC000 <= id && id <= 0xC0FF && \
    "\xFE\xFF\xFF\xFF\xFF\x67\xFE\xFF\xFF\xFF\x33\xCF\xFC\xCF\xFF\xCF" \
    "\x3C\xF3\xFC\x3F\x33\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00" \
    [(id & 0xFF) / 8] & (1 << (id % 8))) \
)
```

Note that according to [HTTP/2 RFC 7540](https://tools.ietf.org/html/rfc7540) the blacklist enforcement is [described](https://tools.ietf.org/html/rfc7540#appendix-A) using the RFC semantic '[MAY](https://tools.ietf.org/html/rfc2119#section-5)' which is the same as 'OPTIONAL'.

[all_cipher_ids.txt](https://github.com/jay/http2_blacklisted_ciphers/blob/master/all_cipher_ids.txt)
------------------
A list of all cipher suites.

[http2_blacklisted_ciphers.txt](https://github.com/jay/http2_blacklisted_ciphers/blob/master/http2_blacklisted_ciphers.txt)
-----------------------------
The TLS 1.2 Cipher Suite Black List from HTTP/2 RFC 7540.

[make_c_test_http2_blacklist.pl](https://github.com/jay/http2_blacklisted_ciphers/blob/master/make_c_test_http2_blacklist.pl)
------------------------------
Use both cipher lists to generate the blacklist in a C struct format and several C methods that can be used to test whether a cipher id is banned.

[runtests.c](https://github.com/jay/http2_blacklisted_ciphers/blob/master/runtests.c)
----------
The C source generated by make_c_test_http2_blacklist.pl.

---

### License

Any code in this project was written to be used by the [cURL project](http://curl.haxx.se/) if necessary and is released under its [MIT/X derivative license](http://curl.haxx.se/docs/copyright.html) with an additional Copyright (C) 2015 Jay Satiro. The cipher lists in the text files do not fall under a license.

### Source

The source can be found on [GitHub](https://github.com/jay/http2_blacklisted_ciphers). Since you're reading this maybe you're already there?

### My Windows results (ie wall clock time):

```
./make_c_test_http2_blacklist.pl > runtests.c
gcc -std=c89 -ansi -pedantic -Wall -Wextra -O3 -o runtests runtests.c
./runtests
```
```
Generating 10000000 random ids.

Testing method 0: IsCipherBannedMethod0: simple loop.
IsCipherBannedMethod0 took 1.252000 seconds.

Testing method 1: IS_CIPHER_BANNED_METHOD1: conditional logic.
IS_CIPHER_BANNED_METHOD1 took 0.072000 seconds.

Testing method 2: IS_CIPHER_BANNED_METHOD2: conditional logic w/ lookup tables.
IS_CIPHER_BANNED_METHOD2 took 0.017000 seconds.

Testing method 3: IsCipherBannedMethod3: binary search.
IsCipherBannedMethod3 took 0.367000 seconds.

Testing method 4: IsCipherBannedMethod4: switch statement.
IsCipherBannedMethod4 took 0.044000 seconds.
```
